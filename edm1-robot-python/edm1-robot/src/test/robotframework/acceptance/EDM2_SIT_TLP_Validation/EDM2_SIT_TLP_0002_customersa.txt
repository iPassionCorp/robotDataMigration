*** Settings ***
Resource          ../../Repositories/${env}/${dbname}_${env}_Connection.txt
Resource          ../../keywords/edm.txt
Library           DatabaseLibrary

*** Test Cases ***
EDM2_SIT_TLP_customersa_0002_0001_DataDict_Validate CustomerCode_Null
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customersa a \ where a.customercode = '' and a.customercode = 'blank'
    EDM_Compare Result    @{Result[0]}    0    CustomerCode

EDM2_SIT_TLP_customersa_0002_0002_DataDict_Validate PolicyNo_Null
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customersa a \ where a.policyno = '' and a.policyno = 'blank'
    EDM_Compare Result    @{Result[0]}    0    PolicyNo

EDM2_SIT_TLP_customersa_0002_0003_Mapping_Validate SA_Life_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_life ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_Life

EDM2_SIT_TLP_customersa_0002_0004_Mapping_Validate SA_ADB_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_adb ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_ADB

EDM2_SIT_TLP_customersa_0002_0005_Mapping_Validate SA_TPD_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_tpd ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_TPD

EDM2_SIT_TLP_customersa_0002_0006_Mapping_Validate SA_TD_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_td ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_TD

EDM2_SIT_TLP_customersa_0002_0007_Mapping_Validate SA_ADD_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_add ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_ADD

EDM2_SIT_TLP_customersa_0002_0008_Mapping_Validate \ SA_ME_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_me ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_ME

EDM2_SIT_TLP_customersa_0002_0009_Validate CustomerCode&PolicyNo_Duplicated
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from \ (select policyno, customercode, count(0) \ from tlp.customersa tlp \ \ group by policyno, customercode \ having count(0) > 1) tmp;
    EDM_Compare Result    @{Result[0]}    0    PolicyDuplicate

EDM2_SIT_TLP_customersa_0002_0010_Mapping_Validate SA_Life_lessthan_0
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) \ FROM tlp.customersa a \ WHERE to_number(a.sa_life,'999999') < 0;
    EDM_Compare Result    @{Result[0]}    0    SA_life

EDM2_SIT_TLP_customersa_0002_0011_DataDict_Validate CustomerCode_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ \ WHERE a.customercode \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    customercode

EDM2_SIT_TLP_customersa_0002_0012_DataDict_Validate PolicyNo_length
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ where length(a.policyno) > 20
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM2_SIT_TLP_customersa_0002_0013_Mapping_Validate SA_Life_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_life ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_life

EDM2_SIT_TLP_customersa_0002_0014_DataDict_Validate SA_LifeTPD_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_lifetpd ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    sa_lifetpd

EDM2_SIT_TLP_customersa_0002_0015_DataDict_Validate SA_LifeTPD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_lifetpd ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_lifetpd

EDM2_SIT_TLP_customersa_0002_0016_DataDict_Validate SA_LifeTPD_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_lifetpd < '0'
    EDM_Compare Result    @{Result[0]}    0    sa_lifetpd

EDM2_SIT_TLP_customersa_0002_0017_Mapping_Validate SA_ADB_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_adb ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_adb

EDM2_SIT_TLP_customersa_0002_0018_Mapping_Validate SA_ADB_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_adb < '0'
    EDM_Compare Result    @{Result[0]}    0    sa_adb

EDM2_SIT_TLP_customersa_0002_0019_Mapping_Validate SA_TPD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_tpd ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_tpd

EDM2_SIT_TLP_customersa_0002_0020_Mapping_Validate SA_TPD_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_tpd < '0'
    EDM_Compare Result    @{Result[0]}    0    sa_tpd

EDM2_SIT_TLP_customersa_0002_0021_Mapping_Validate SA_TD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_td ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_td

EDM2_SIT_TLP_customersa_0002_0022_Mapping_Validate SA_TD_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_td < '0'
    EDM_Compare Result    @{Result[0]}    0    sa_td

EDM2_SIT_TLP_customersa_0002_0023_Mapping_Validate SA_ADD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_add ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_add

EDM2_SIT_TLP_customersa_0002_0024_Mapping_Validate SA_ADD_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_add < '0'
    EDM_Compare Result    @{Result[0]}    0    sa_add

EDM2_SIT_TLP_customersa_0002_0025_Mapping_Validate SA_ME_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_me ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_ME

EDM2_SIT_TLP_customersa_0002_0026_Mapping_Validate SA_ME_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_me < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_ME

EDM2_SIT_TLP_customersa_0002_0027_DataDict_Validate SA_HA_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.sa_ha ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    sa_ha

EDM2_SIT_TLP_customersa_0002_0028_DataDict_Validate SA_HA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_ha ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    sa_ha

EDM2_SIT_TLP_customersa_0002_0029_DataDict_Validate SA_HA_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.sa_ha < '0'
    EDM_Compare Result    @{Result[0]}    0    sa_ha

EDM2_SIT_TLP_customersa_0002_0030_DataDict_Validate SA_HB_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA_HB ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_HB

EDM2_SIT_TLP_customersa_0002_0031_DataDict_Validate SA_HB_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_HB ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_HB

EDM2_SIT_TLP_customersa_0002_0032_DataDict_Validate SA_HB_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_HB < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_HB

EDM2_SIT_TLP_customersa_0002_0033_DataDict_Validate SA_PA_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA_PA ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_PA

EDM2_SIT_TLP_customersa_0002_0034_DataDict_Validate SA_PA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_PA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_PA

EDM2_SIT_TLP_customersa_0002_0035_DataDict_Validate SA_PA_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_PA < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_PA

EDM2_SIT_TLP_customersa_0002_0036_DataDict_Validate SA_PH_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA_PH ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_PH

EDM2_SIT_TLP_customersa_0002_0037_DataDict_Validate SA_PH_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_PH ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_PH

EDM2_SIT_TLP_customersa_0002_0038_DataDict_Validate SA_PH_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_PH < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_PH

EDM2_SIT_TLP_customersa_0002_0039_DataDict_Validate SA_CI_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA_CI ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_CI

EDM2_SIT_TLP_customersa_0002_0040_DataDict_Validate SA_CI_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_CI ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_CI

EDM2_SIT_TLP_customersa_0002_0041_DataDict_Validate SA_CI_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_CI < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_CI

EDM2_SIT_TLP_customersa_0002_0042_DataDict_Validate FLAGLIFE_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.FLAGLIFE ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    FLAGLIFE

EDM2_SIT_TLP_customersa_0002_0043_DataDict_Validate FLAGLIFE_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.FLAGLIFE < '0'
    EDM_Compare Result    @{Result[0]}    0    FLAGLIFE

EDM2_SIT_TLP_customersa_0002_0044_DataDict_Validate FLAGLIFETPD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.FLAGLIFETPD ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    FLAGLIFETPD

EDM2_SIT_TLP_customersa_0002_0045_DataDict_Validate FLAGLIFETPD_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.FLAGLIFETPD < '0'
    EDM_Compare Result    @{Result[0]}    0    FLAGLIFETPD

EDM2_SIT_TLP_customersa_0002_0046_DataDict_Validate IA_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.IA ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    IA

EDM2_SIT_TLP_customersa_0002_0047_DataDict_Validate IA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.IA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    IA

EDM2_SIT_TLP_customersa_0002_0048_DataDict_Validate IA_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.IA < '0'
    EDM_Compare Result    @{Result[0]}    0    IA

EDM2_SIT_TLP_customersa_0002_0049_DataDict_Validate SA_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA

EDM2_SIT_TLP_customersa_0002_0050_DataDict_Validate SA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA

EDM2_SIT_TLP_customersa_0002_0051_DataDict_Validate SA_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA < '0'
    EDM_Compare Result    @{Result[0]}    0    SA

EDM2_SIT_TLP_customersa_0002_0052_DataDict_Validate TransDate_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.transdate ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    transdate

EDM2_SIT_TLP_customersa_0002_0053_DataDict_Validate TransDate_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (transdate not between '0000-00-00' and '3000-12-31') and transdate != '00000000'
    EDM_Compare Result    @{Result[0]}    0    transdate

EDM2_SIT_TLP_customersa_0002_0054_DataDict_Validate TransDate_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(transdate) <> 8
    EDM_Compare Result    @{Result[0]}    0    transdate

EDM2_SIT_TLP_customersa_0002_0055_DataDict_Validate MI_AMOUNT_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.MI_AMOUNT ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    MI_AMOUNT

EDM2_SIT_TLP_customersa_0002_0056_DataDict_Validate MI_AMOUNT_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.MI_AMOUNT ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    MI_AMOUNT

EDM2_SIT_TLP_customersa_0002_0057_DataDict_Validate MI_AMOUNT_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.MI_AMOUNT < '0'
    EDM_Compare Result    @{Result[0]}    0    MI_AMOUNT

EDM2_SIT_TLP_customersa_0002_0058_DataDict_Validate Expiry_Life_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_Life ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_Life

EDM2_SIT_TLP_customersa_0002_0059_DataDict_Validate Expiry_Life_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (expiry_life not between '0000-00-00' and '3000-12-31') and expiry_life != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_Life

EDM2_SIT_TLP_customersa_0002_0060_DataDict_Validate Expiry_Life_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(expiry_life) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_Life

EDM2_SIT_TLP_customersa_0002_0061_DataDict_Validate Expiry_TPD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_TPD ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_TPD

EDM2_SIT_TLP_customersa_0002_0062_DataDict_Validate Expiry_TPD_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_TPD not between '0000-00-00' and '3000-12-31') and Expiry_TPD != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_TPD

EDM2_SIT_TLP_customersa_0002_0063_DataDict_Validate Expiry_TPD_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_TPD) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_TPD

EDM2_SIT_TLP_customersa_0002_0064_DataDict_Validate Expiry_TD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_TD ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_TD

EDM2_SIT_TLP_customersa_0002_0065_DataDict_Validate Expiry_TD_CheckDate
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_TD not between '0000-00-00' and '3000-12-31') and Expiry_TD != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_TD

EDM2_SIT_TLP_customersa_0002_0066_DataDict_Validate Expiry_TD_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_TD) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_TD

EDM2_SIT_TLP_customersa_0002_0067_DataDict_Validate \ Expiry_ADD_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_ADD ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_ADD

EDM2_SIT_TLP_customersa_0002_0068_DataDict_Validate \ Expiry_ADD_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_ADD not between '0000-00-00' and '3000-12-31') and Expiry_ADD != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_ADD

EDM2_SIT_TLP_customersa_0002_0069_DataDict_Validate \ Expiry_ADD_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_ADD) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_ADD

EDM2_SIT_TLP_customersa_0002_0070_DataDict_Validate Expiry_ADB_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_ADB ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_ADB

EDM2_SIT_TLP_customersa_0002_0071_DataDict_Validate Expiry_ADB_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_ADB not between '0000-00-00' and '3000-12-31') and Expiry_ADB != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_ADB

EDM2_SIT_TLP_customersa_0002_0072_DataDict_Validate Expiry_ADB_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_ADB) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_ADB

EDM2_SIT_TLP_customersa_0002_0073_DataDict_Validate Expiry_HA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_HA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_HA

EDM2_SIT_TLP_customersa_0002_0074_DataDict_Validate Expiry_HA_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_HA not between '0000-00-00' and '3000-12-31') and Expiry_HA != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_HA

EDM2_SIT_TLP_customersa_0002_0075_DataDict_Validate Expiry_HA_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_HA) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_HA

EDM2_SIT_TLP_customersa_0002_0076_DataDict_Validate Expiry_HB_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_HB ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_HB

EDM2_SIT_TLP_customersa_0002_0077_DataDict_Validate Expiry_HB_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_HB not between '0000-00-00' and '3000-12-31') and Expiry_HB != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_HB

EDM2_SIT_TLP_customersa_0002_0078_DataDict_Validate Expiry_HB_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_HB) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_HB

EDM2_SIT_TLP_customersa_0002_0079_DataDict_Validate Expiry_ME_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_ME ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_ME

EDM2_SIT_TLP_customersa_0002_0080_DataDict_Validate Expiry_ME_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_ME not between '0000-00-00' and '3000-12-31') and Expiry_ME != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_ME

EDM2_SIT_TLP_customersa_0002_0081_DataDict_Validate Expiry_ME_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_ME) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_ME

EDM2_SIT_TLP_customersa_0002_0082_DataDict_Validate Expiry_PA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_PA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_PA

EDM2_SIT_TLP_customersa_0002_0083_DataDict_Validate Expiry_PA_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_PA not between '0000-00-00' and '3000-12-31') and Expiry_PA != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_PA

EDM2_SIT_TLP_customersa_0002_0084_DataDict_Validate Expiry_PA_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_PA) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_PA

EDM2_SIT_TLP_customersa_0002_0085_DataDict_Validate Expiry_PH_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_PH ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_PH

EDM2_SIT_TLP_customersa_0002_0086_DataDict_Validate Expiry_PH_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_PH not between '0000-00-00' and '3000-12-31') and Expiry_PH != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_PH

EDM2_SIT_TLP_customersa_0002_0087_DataDict_Validate Expiry_PH_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_PH) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_PH

EDM2_SIT_TLP_customersa_0002_0088_DataDict_Validate Expiry_CI_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_CI ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_CI

EDM2_SIT_TLP_customersa_0002_0089_DataDict_Validate Expiry_CI_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_CI not between '0000-00-00' and '3000-12-31') and Expiry_CI != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_CI

EDM2_SIT_TLP_customersa_0002_0090_DataDict_Validate Expiry_CI_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_CI) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_CI

EDM2_SIT_TLP_customersa_0002_0091_DataDict_ValidateSA_MA_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA_MA ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_MA

EDM2_SIT_TLP_customersa_0002_0092_DataDict_Validate SA_MA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_MA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_MA

EDM2_SIT_TLP_customersa_0002_0093_DataDict_Validate SA_MA_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_MA < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_MA

EDM2_SIT_TLP_customersa_0002_0094_DataDict_Validate Expiry_MA_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_MA ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_MA

EDM2_SIT_TLP_customersa_0002_0095_DataDict_Validate Expiry_MA_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_MA not between '0000-00-00' and '3000-12-31') and Expiry_MA != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_MA

EDM2_SIT_TLP_customersa_0002_0096_DataDict_Validate Expiry_MA_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_MA) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_MA

EDM2_SIT_TLP_customersa_0002_0097_DataDict_Validate SA_MC_Decimal
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customersa a where a.SA_MC ~* '^(\d*\.\d+)';
    EDM_Compare Result    @{Result[0]}    0    SA_MC

EDM2_SIT_TLP_customersa_0002_0098_DataDict_Validate SA_MC_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_MC ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    SA_MC

EDM2_SIT_TLP_customersa_0002_0099_DataDict_Validate SA_MC_LessThanZero
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.SA_MC < '0'
    EDM_Compare Result    @{Result[0]}    0    SA_MC

EDM2_SIT_TLP_customersa_0002_0100_DataDict_Validate Expiry_MC_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customersa a \ WHERE a.Expiry_MC ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Expiry_MC

EDM2_SIT_TLP_customersa_0002_0101_DataDict_Validate Expiry_MC_CheckDefault
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where (Expiry_MC not between '0000-00-00' and '3000-12-31') and Expiry_MC != '00000000'
    EDM_Compare Result    @{Result[0]}    0    Expiry_MC

EDM2_SIT_TLP_customersa_0002_0103_Validate CheckPolicynotinCustomerinfo
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ (select a.policyno, a.customercode FROM tlp.customerinfo a \ where a.customerstatus in \ \ (select customerstatus from lookup.tlppolicystatus) \ except all \ select b.policyno, b.customercode \ from tlp.customersa b where policyno not in ('00006001','00006002','00006003' ,'00006008','00006009','01006012','01006013','BC00600100','BC00600200','BC00600300','BC00600500','BC00600500','BC00600800' ,'BC00601100','BC00601200','BC00601300','BC00601301','BC00601400','BC00601500','BC00601501','BC00601600','BC00601700','BC00601701','BC00601800' ,'BC00601801','BC00601900','BC00602000','BC00602101','BC00602200','BC00603200','BC00603300','BC00603400')) tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM2_SIT_TLP_customersa_0002_0102_Validate Expiry_MC_Checklength
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.customersa \ where length(Expiry_MC) <> 8
    EDM_Compare Result    @{Result[0]}    0    Expiry_MC

EDM2_SIT_TLP_customersa_0002_0104_Validate CheckPolicynotinsplitamount
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ \ (select a.grouppolicyno, a.customercode FROM tlp.splitpremiumamount a \ group by grouppolicyno,customercode except all \ select b.policyno, b.customercode \ from tlp.customersa b where policyno not in ('00006001','00006002','00006003' ,'00006008','00006009','01006012','01006013','BC00600100','BC00600200','BC00600300','BC00600500','BC00600500','BC00600800' ,'BC00601100','BC00601200','BC00601300','BC00601301','BC00601400','BC00601500','BC00601501','BC00601600','BC00601700','BC00601701','BC00601800' ,'BC00601801','BC00601900','BC00602000','BC00602101','BC00602200','BC00603200','BC00603300','BC00603400')) tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM2_SIT_TLP_customersa_0002_0105_Validate CheckPolicynotinpayment
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ \ (select a.policyno, a.customercode FROM tlp.payment a \ group by policyno,customercode except all \ select b.policyno, b.customercode \ from tlp.customersa b where policyno not in ('00006001','00006002','00006003' ,'00006008','00006009','01006012','01006013','BC00600100','BC00600200','BC00600300','BC00600500','BC00600500','BC00600800' ,'BC00601100','BC00601200','BC00601300','BC00601301','BC00601400','BC00601500','BC00601501','BC00601600','BC00601700','BC00601701','BC00601800' ,'BC00601801','BC00601900','BC00602000','BC00602101','BC00602200','BC00603200','BC00603300','BC00603400')) tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM2_SIT_TLP_customersa_0002_0106_Validate CheckPolicynoDuplicate
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from \ (select policyno, customercode, count(0) \ from tlp.customersa tlp \ \ group by policyno, customercode \ having count(0) > 1) tmp;
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM2_SIT_TLP_customersa_0002_0107_Mapping_Validate SA_Life_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customersa a \ where a.SA_Life= '' or a.SA_Life= 'blank';
    EDM_Compare Result    @{Result[0]}    0    SA_Life

EDM2_SIT_TLP_customersa_0002_0108_Mapping_Validate SA_ADD_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customersa a \ where a.SA_ADD= '' or a.SA_ADD= 'blank';
    EDM_Compare Result    @{Result[0]}    0    SA_ADD

EDM2_SIT_TLP_customersa_0002_0109_Mapping_Validate SA_ADB_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customersa a \ where a.SA_ADB= '' or a.SA_ADB= 'blank';
    EDM_Compare Result    @{Result[0]}    0    SA_ADB

EDM2_SIT_TLP_customersa_0002_0110_Mapping_Validate SA_TPD_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customersa a \ where a.SA_TPD= '' or a.SA_TPD= 'blank';
    EDM_Compare Result    @{Result[0]}    0    SA_TPD

EDM2_SIT_TLP_customersa_0002_0111_Mapping_Validate SA_TD_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customersa a \ where a.SA_TD= '' or a.SA_TD= 'blank';
    EDM_Compare Result    @{Result[0]}    0    SA_TD

EDM2_SIT_TLP_customersa_0002_0112_Mapping_Validate SA_ME_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customersa a \ where a.SA_ME= '' or a.SA_ME= 'blank';
    EDM_Compare Result    @{Result[0]}    0    SA_ME
