*** Settings ***
Library           DatabaseLibrary
Resource          ../../keywords/edm.txt
Resource          ../../Repositories/${env}/${dbname}_${env}_Connection.txt

*** Test Cases ***
EDM4_SIT_[CF]_0001_0001_Validate compensateID_Length
    EDM_Connect_DB
    @{Result}    Query    select count(*) \ from dm.compensateid a \ \ inner join dm.cert b on a.compensateid = b.nameid \ inner join dm.tlpmigration c on c.tlipolicyno = b.policyno \ and c.customercode = b.certno \ \ where length(a.compensateID) > 13;
    EDM_Compare Result    @{Result[0]}    0    compensateID

EDM4_SIT_[CF]_0001_0002_Validate compensateID_Validate compensateIDDuplicate
    EDM_Connect_DB
    @{Result}    Query    select count(0) from (select a.compensateID from dm.compensateid a \ \ inner join dm.cert b on a.compensateid = b.nameid \ inner join dm.tlpmigration c on c.tlipolicyno = b.policyno \ and c.customercode = b.certno \ \ \ group by a.compensateID having count(0) > 1) tmp
    EDM_Compare Result    @{Result[0]}    0    compensateID

EDM4_SIT_[CF]_0001_0003_Validate referenceID_Length
    EDM_Connect_DB
    @{Result}    Query    select count(*) \ from dm.compensateid a \ \ inner join dm.cert b on a.compensateid = b.nameid \ inner join dm.tlpmigration c on c.tlipolicyno = b.policyno \ and c.customercode = b.certno \ \ where length(a.referenceID) > 13;
    EDM_Compare Result    @{Result[0]}    0    referenceID
