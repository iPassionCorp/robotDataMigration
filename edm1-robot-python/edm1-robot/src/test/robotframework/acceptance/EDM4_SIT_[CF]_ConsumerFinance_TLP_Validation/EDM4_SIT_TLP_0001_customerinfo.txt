*** Settings ***
Library           DatabaseLibrary
Resource          ../../keywords/edm.txt
Resource          ../../Repositories/${env}/${dbname}_${env}_Connection.txt

*** Test Cases ***
EDM4_SIT_TLP_customerinfo_0001_0001_Validate Gender F&M
    [Documentation]    1.set Gender \ โดยเช็คว่า ถ้าไม่ใช่ Fและ M ให้ write error
    ...    - Case: Set Gender ตรวจสอบ Gender 'F'&'M'
    EDM_Connect_DB
    @{Result}    Query    select \ \ count(*) \ from tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and a.gender not in ('F','M');
    EDM_Compare Result    @{Result[0]}    0    Gender

EDM4_SIT_TLP_customerinfo_0001_0002_Validate CertificateNo_Null
    [Documentation]    2.set CertificateNo โดยเช็คว่า \ \ เป็นว่าง ให้ write error
    ...    - Case: Set CertificateNo ตรวจสอบค่าว่าง ยกเว้น Policy No ที่เป็น Free PA
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a \ \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and a.certificateno = '' or a.certificateno = 'blank' and a.policyno not in ('00026009','00026010')
    EDM_Compare Result    @{Result[0]}    0    CertificateNo

EDM4_SIT_TLP_customerinfo_0001_0003_Validate PercentOfBenefitciary2_isNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customerinfo a \ \ WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.percentofbenefitciary2 \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    PercentOfBenefitciary2

EDM4_SIT_TLP_customerinfo_0001_0004_Validate PercentOfBenefitciary2_notNull
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customerinfo a WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.percentofbenefitciary2 = '' and a.nameofbenefit2 <> '' ;
    EDM_Compare Result    @{Result[0]}    0    PercentOfBenefitciary2

EDM4_SIT_TLP_customerinfo_0001_0005_Validate PercentOfBenefitciary3_isNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) \ FROM tlp.customerinfo a WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.percentofbenefitciary3 \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    PercentOfBenefitciary3

EDM4_SIT_TLP_customerinfo_0001_0006_Validate PercentOfBenefitciary3_notNull
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) \ FROM tlp.customerinfo a \ WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.percentofbenefitciary3 = '' and a.nameofbenefit3 <> '';
    EDM_Compare Result    @{Result[0]}    0    PercentOfBenefitciary3

EDM4_SIT_TLP_customerinfo_0001_0007_Validate PercentOfBenefitciary4_isNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) \ FROM tlp.customerinfo a WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.percentofbenefitciary4 \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    PercentOfBenefitciary4

EDM4_SIT_TLP_customerinfo_0001_0008_Validate PercentOfBenefitciary4_notNull
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) \ FROM tlp.customerinfo a \ WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.percentofbenefitciary4 = '' and a.nameofbenefit4 <> '';
    EDM_Compare Result    @{Result[0]}    0    PercentOfBenefitciary4

EDM4_SIT_TLP_customerinfo_0001_0009_Validate Relationship2_isNotChar
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ FROM tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nameofbenefit2 <> '' \ and a.relationship2 \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Relationship2

EDM4_SIT_TLP_customerinfo_0001_0010_Validate Relationship2_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nameofbenefit2 <> '' \ and a.relationship2 = '' or a.relationship2 in ('NULL', 'Null', 'null')
    EDM_Compare Result    @{Result[0]}    0    Relationship2

EDM4_SIT_TLP_customerinfo_0001_0011_Validate Relationship3_isNotChar
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ FROM tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nameofbenefit3 <> '' \ and a.relationship3 \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Relationship3

EDM4_SIT_TLP_customerinfo_0001_0012_Validate Relationship3_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nameofbenefit3 <> '' \ and a.relationship3 = '' or a.relationship3 in ('NULL', 'Null', 'null')
    EDM_Compare Result    @{Result[0]}    0    Relationship3

EDM4_SIT_TLP_customerinfo_0001_0013_Validate Relationship4_isNotChar
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ FROM tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nameofbenefit4 <> '' \ and a.relationship4 \ ~* '[a-zก-ฮ]';
    EDM_Compare Result    @{Result[0]}    0    Relationship4

EDM4_SIT_TLP_customerinfo_0001_0014_Validate Relationship4_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nameofbenefit4 <> '' \ and a.relationship4 = '' or a.relationship4 in ('NULL', 'Null', 'null')
    EDM_Compare Result    @{Result[0]}    0    Relationship4

EDM4_SIT_TLP_customerinfo_0001_0017_Validate HomeTel_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.hometel) \ > 100
    EDM_Compare Result    @{Result[0]}    0    HomeTel

EDM4_SIT_TLP_customerinfo_0001_0018_Validate MobileTel_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.mobiletel) \ > 100
    EDM_Compare Result    @{Result[0]}    0    MobileTel

EDM4_SIT_TLP_customerinfo_0001_0019_Validate OfficeTel_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.officetel) \ > 100
    EDM_Compare Result    @{Result[0]}    0    OfficeTel

EDM4_SIT_TLP_customerinfo_0001_0020_Validate PartnerNamel_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.partnername) \ > 100 and a.partnername = substring(a.partnername,1,100)
    EDM_Compare Result    @{Result[0]}    0    PartnerNamel

EDM4_SIT_TLP_customerinfo_0001_0021_Validate NationID_13Digits
    [Documentation]    customerinfo.NationID เช็คว่าความยาวไม่เท่ากับ 13 ให้ใส่ค่า \ N000000000000 และ write error
    ...
    ...    [20180222]
    ...    สิ่งที่เอาเข้าระบบ TLI ได้
    ...    - เลข 13 หลักเอาเข้า default เป็นเลข ปปช
    ...    - เลขพาสปอาร์ตที่มีรหัสประเทศ 3 หลักอยู่ด้านหน้าตามด้วยเลขพาสปอร์ต
    ...    - ถ้าไม่ครบ 13 หลักทาง TLP จะเปลี่ยนเป็น "N000000000000" มาให้
    ...    - ทาง TLP convert เลขพาสปอร์ตให้อยู่ในรูปแบบ รหัสประเทศ 3 หลัก +เลขพาสปอาร์ตแล้ว
    EDM_Connect_DB
    @{Result}    Query    select count(a.nationid) from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nationid) <> 13
    EDM_Compare Result    @{Result[0]}    0    NationID

EDM4_SIT_TLP_customerinfo_0001_0022_Validate NationID_N0000000000000
    [Documentation]    customerinfo.NationID เช็คว่าความยาวไม่เท่ากับ 13 ให้ใส่ค่า \ N000000000000 และ write error
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.nationid like '%N000000000000%' and length(a.nationid) < 12;
    EDM_Compare Result    @{Result[0]}    0    NationID_N000000000000

EDM4_SIT_TLP_customerinfo_0001_0023_Validate CustomerStatus
    EDM_Connect_DB
    @{Result}    Query    select count (0) \ from tlp.customerinfo a \ where a.customerstatus = '' or a.customerstatus in ('NULL', 'Null', 'null');
    EDM_Compare Result    @{Result[0]}    0    CustomerStatus

EDM4_SIT_TLP_customerinfo_0001_0024_Validate DeadDate_EqaulZero
    [Documentation]    จากเงื่อนไข
    ...    - customerinfo.CustomerStatus == Active และ
    ...    - customerinfo.deadDate เป็นว่างหรือ 0 ให้ write error และไม่ลงแฟ้ม
    EDM_Connect_DB
    @{Result}    Query    select count(tmp.policyno) from ( select a.policyno, a.customerstatus, \ a.deaddate from tlp.customerinfo a \ where a.customerstatus = 'Active' and (a.deaddate = '' or a.deaddate = '0') group by a.policyno, a.customerstatus, a.deaddate ) tmp
    EDM_Compare Result    @{Result[0]}    0    DeadDate

EDM4_SIT_TLP_customerinfo_0001_0025_Validate CustomerInfoStatus
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.status not in ('S','M','D','W','','blank')
    EDM_Compare Result    @{Result[0]}    0    status

EDM4_SIT_TLP_customerinfo_0001_0026_Validate loanNo
    Comment    EDM_Connect_DB
    Comment    @{Result}    Query
    Comment    EDM_Compare Result    @{Result[0]}    0    DeadDate

EDM4_SIT_TLP_customerinfo_0001_0027_Validate med
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.med not in ('Y', 'N', '');
    EDM_Compare Result    @{Result[0]}    0    MED

EDM4_SIT_TLP_customerinfo_0001_0028_Validate Gender
    [Documentation]    Validate Gender is blank --> ERR_G
    EDM_Connect_DB
    @{Result}    Query    select \ count(0) \ from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and a.gender = '' or \ a.gender in ('Blank', 'BLANK','blank') or \ a.gender in ('Null', 'NULL','null')
    EDM_Compare Result    @{Result[0]}    0    Gender

EDM_SIT_TLP_customerinfo_0001_0029_Validate ProductName_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.productname) > 100;
    EDM_Compare Result    @{Result[0]}    0    productname

EDM_SIT_TLP_customerinfo_0001_0030_Validate PolicyNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.policyno) > 30;
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM_SIT_TLP_customerinfo_0001_0031_Validate ProductCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.productcode) > 30;
    EDM_Compare Result    @{Result[0]}    0    productcode

EDM_SIT_TLP_customerinfo_0001_0032_Validate CertificateNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.certificateno) > 30;
    EDM_Compare Result    @{Result[0]}    0    certificateno

EDM_SIT_TLP_customerinfo_0001_0033_Validate BranchName_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.branchname) > 200;
    EDM_Compare Result    @{Result[0]}    0    branchname

EDM_SIT_TLP_customerinfo_0001_0034_Validate CustomerCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.customercode) > 80;
    EDM_Compare Result    @{Result[0]}    0    customercode

EDM_SIT_TLP_customerinfo_0001_0035_Validate AccountNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.accountno) > 50;
    EDM_Compare Result    @{Result[0]}    0    accountno

EDM_SIT_TLP_customerinfo_0001_0036_Validate LoanNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.loanno) > 50;
    EDM_Compare Result    @{Result[0]}    0    loanno

EDM_SIT_TLP_customerinfo_0001_0037_Validate InsuranceStatus_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.insurancestatus) > 50;
    EDM_Compare Result    @{Result[0]}    0    insurancestatus

EDM_SIT_TLP_customerinfo_0001_0038_Validate CustomerStatus_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.customerstatus) > 50;
    EDM_Compare Result    @{Result[0]}    0    customerstatus

EDM_SIT_TLP_customerinfo_0001_0039_Validate CancelReason_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.cancelreason) > 500;
    EDM_Compare Result    @{Result[0]}    0    cancelreason

EDM_SIT_TLP_customerinfo_0001_0040_Validate CancelDescription_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.canceldescription) > 500;
    EDM_Compare Result    @{Result[0]}    0    canceldescription

EDM_SIT_TLP_customerinfo_0001_0041_Validate Cannel_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.channel) > 10;
    EDM_Compare Result    @{Result[0]}    0    channel

EDM_SIT_TLP_customerinfo_0001_0042_Validate Prefix_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.prefix) > 150;
    EDM_Compare Result    @{Result[0]}    0    prefix

EDM_SIT_TLP_customerinfo_0001_0043_Validate NameTH_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nameth) > 200;
    EDM_Compare Result    @{Result[0]}    0    nameth

EDM_SIT_TLP_customerinfo_0001_0044_Validate SurnameTH_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.surnameth) > 200;
    EDM_Compare Result    @{Result[0]}    0    surnameth

EDM_SIT_TLP_customerinfo_0001_0045_Validate Gender_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.gender) > 50;
    EDM_Compare Result    @{Result[0]}    0    Gender

EDM_SIT_TLP_customerinfo_0001_0046_Validate Status_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.status) > 50;
    EDM_Compare Result    @{Result[0]}    0    status

EDM_SIT_TLP_customerinfo_0001_0047_Validate NationID_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nationid) > 50;
    EDM_Compare Result    @{Result[0]}    0    nationid

EDM_SIT_TLP_customerinfo_0001_0048_Validate CreditCardNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.creditcardno) > 50;
    EDM_Compare Result    @{Result[0]}    0    creditcardno

EDM_SIT_TLP_customerinfo_0001_0049_Validate ExpiredCreditCard_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.expiredcreditcard) > 50;
    EDM_Compare Result    @{Result[0]}    0    expiredcreditcard

EDM_SIT_TLP_customerinfo_0001_0050_Validate Address1_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.address1) > 255;
    EDM_Compare Result    @{Result[0]}    0    address1

EDM_SIT_TLP_customerinfo_0001_0051_Validate Address2_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.address2) > 255;
    EDM_Compare Result    @{Result[0]}    0    address2

EDM_SIT_TLP_customerinfo_0001_0052_Validate AddressOffice1_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.addressoffice1) > 255;
    EDM_Compare Result    @{Result[0]}    0    addressoffice1

EDM_SIT_TLP_customerinfo_0001_0053_Validate AddressOffice2_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.addressoffice2) > 255;
    EDM_Compare Result    @{Result[0]}    0    addressoffice2

EDM_SIT_TLP_customerinfo_0001_0054_Validate NameOfBenefit1_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nameofbenefit1) > 200;
    EDM_Compare Result    @{Result[0]}    0    nameofbenefit1

EDM_SIT_TLP_customerinfo_0001_0055_Validate NameOfBenefit2_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nameofbenefit2) > 200;
    EDM_Compare Result    @{Result[0]}    0    nameofbenefit2

EDM_SIT_TLP_customerinfo_0001_0056_Validate NameOfBenefit3_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nameofbenefit3) > 200;
    EDM_Compare Result    @{Result[0]}    0    nameofbenefit3

EDM_SIT_TLP_customerinfo_0001_0057_Validate NameOfBenefit4_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.nameofbenefit1) > 200;
    EDM_Compare Result    @{Result[0]}    0    nameofbenefit1

EDM_SIT_TLP_customerinfo_0001_0058_Validate Relationship1_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.relationship1) > 200;
    EDM_Compare Result    @{Result[0]}    0    relationship1

EDM_SIT_TLP_customerinfo_0001_0059_Validate Relationship2_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.relationship2) > 200;
    EDM_Compare Result    @{Result[0]}    0    relationship2

EDM_SIT_TLP_customerinfo_0001_0060_Validate Relationship3_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.relationship3) > 200;
    EDM_Compare Result    @{Result[0]}    0    relationship3

EDM_SIT_TLP_customerinfo_0001_0061_Validate Relationship4_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.relationship4) > 200;
    EDM_Compare Result    @{Result[0]}    0    relationship4

EDM_SIT_TLP_customerinfo_0001_0062_Validate OfficerCodeSale_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.officercodesale) > 100;
    EDM_Compare Result    @{Result[0]}    0    officercodesale

EDM_SIT_TLP_customerinfo_0001_0063_Validate SaleNameTH_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.salenameth) > 100;
    EDM_Compare Result    @{Result[0]}    0    salenameth

EDM_SIT_TLP_customerinfo_0001_0064_Validate ManagerCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.managercode) > 100;
    EDM_Compare Result    @{Result[0]}    0    managercode

EDM_SIT_TLP_customerinfo_0001_0065_Validate CancelLetterNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.cancelletterno) > 100;
    EDM_Compare Result    @{Result[0]}    0    cancelletterno

EDM_SIT_TLP_customerinfo_0001_0066_Validate PartnerCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.partnercode) > 100;
    EDM_Compare Result    @{Result[0]}    0    partnercode

EDM_SIT_TLP_customerinfo_0001_0067_Validate DatabaseSource_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.databasesource) > 100;
    EDM_Compare Result    @{Result[0]}    0    databasesource

EDM_SIT_TLP_customerinfo_0001_0068_Validate FACILITY_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.facility) > 100;
    EDM_Compare Result    @{Result[0]}    0    facility

EDM_SIT_TLP_customerinfo_0001_0069_Validate UWDescription_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.uwdescription) > 200;
    EDM_Compare Result    @{Result[0]}    0    uwdescription

EDM_SIT_TLP_customerinfo_0001_0070_Validate UWStatus_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.uwstatus) > 50;
    EDM_Compare Result    @{Result[0]}    0    uwstatus

EDM_SIT_TLP_customerinfo_0001_0071_Validate Coverage_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.coverage) > 500;
    EDM_Compare Result    @{Result[0]}    0    coverage

EDM_SIT_TLP_customerinfo_0001_0072_Validate VoiceTag_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.voicetag) > 500;
    EDM_Compare Result    @{Result[0]}    0    VoiceTag

EDM_SIT_TLP_customerinfo_0001_0073_Validate Lob_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.lob) > 20;
    EDM_Compare Result    @{Result[0]}    0    lob

EDM_SIT_TLP_customerinfo_0001_0074_Validate OldAccountNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.oldaccountno) > 50;
    EDM_Compare Result    @{Result[0]}    0    oldaccountno

EDM_SIT_TLP_customerinfo_0001_0075_Validate CustomerOccupationText_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.customeroccupationtext) > 100;
    EDM_Compare Result    @{Result[0]}    0    customeroccupationtext

EDM_SIT_TLP_customerinfo_0001_0076_Validate CustomerContractOfficePay_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.customercontactofficepay) > 100;
    EDM_Compare Result    @{Result[0]}    0    customercontactofficepay

EDM_SIT_TLP_customerinfo_0001_0077_Validate PercenOfBenefitciary1_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.percentofbenefitciary1) > 20;
    EDM_Compare Result    @{Result[0]}    0    percentofbenefitciary1

EDM_SIT_TLP_customerinfo_0001_0078_Validate PercenOfBenefitciary2_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.percentofbenefitciary2) > 20;
    EDM_Compare Result    @{Result[0]}    0    percentofbenefitciary2

EDM_SIT_TLP_customerinfo_0001_0079_Validate PercenOfBenefitciary3_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.percentofbenefitciary3) > 20;
    EDM_Compare Result    @{Result[0]}    0    percentofbenefitciary3

EDM_SIT_TLP_customerinfo_0001_0080_Validate PercenOfBenefitciary4_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.percentofbenefitciary4) > 20;
    EDM_Compare Result    @{Result[0]}    0    percentofbenefitciary4

EDM_SIT_TLP_customerinfo_0001_0081_Validate Med_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.med) > 1;
    EDM_Compare Result    @{Result[0]}    0    med

EDM_SIT_TLP_customerinfo_0001_0082_Validate CustomerNation_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and length(a.customernation) > 50;
    EDM_Compare Result    @{Result[0]}    0    customernation

EDM_SIT_TLP_customerinfo_0001_0083_Validate PolicyNo_CheckDataExceptDocument
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo \ except \ select tlpplancode from lookup.smi;
    EDM_Compare Result    @{Result[0]}    0    PolicyNo

EDM_SIT_TLP_customerinfo_0001_0084_Validate PolicyNo_CheckDataMissingDocument
    EDM_Connect_DB
    @{Result}    Query    select count(0) from lookup.smi except select policyno from tlp.customerinfo;
    EDM_Compare Result    @{Result[0]}    0    PolicyNo

EDM_SIT_TLP_customerinfo_0001_0085_Validate Policyno,customercode,customerstatus,productcode,certificateno_Duplicate
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ (select a.policyno, a.customercode,a.customerstatus,a.certificateno,a.productcode \ FROM tlp.customerinfo a \ \ where a.customerstatus in \ \ \ (select customerstatus from lookup.tlppolicystatus) \ \ group by policyno, customercode,customerstatus,a.certificateno,a.productcode \ having count(0) > 1) tmp
    EDM_Compare Result    @{Result[0]}    0    Policyno,customercode,customerstatus

EDM_SIT_TLP_customerinfo_0001_0086_Validate NameOfBenefit2_NotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customerinfo a \ WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and \ a.nameofbenefit2 !~* '[ก-ฮA-Za-z]' and a.nameofbenefit2 <> '';
    EDM_Compare Result    @{Result[0]}    0    nameofbenefit2

EDM_SIT_TLP_customerinfo_0001_0087_Validate NameOfBenefit3_NotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.customerinfo a \ WHERE a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and \ a.nameofbenefit3 !~* '[ก-ฮA-Za-z]' and a.nameofbenefit3 <> '';
    EDM_Compare Result    @{Result[0]}    0    nameofbenefit2

EDM_SIT_TLP_customerinfo_0001_0088_Validate ProductCode_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and productcode ='' or productcode ='blank' or productcode is null
    EDM_Compare Result    @{Result[0]}    0    productcode

EDM_SIT_TLP_customerinfo_0001_0089_Validate ProductName_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) and productname ='' or productname ='blank' or productname is null
    EDM_Compare Result    @{Result[0]}    0    productname

EDM_SIT_TLP_customerinfo_0001_0090_Validate PolicyNo_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and policyno ='' or policyno ='blank' or policyno is null
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM_SIT_TLP_customerinfo_0001_0091_Validate Age_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and age ='' or age ='blank'
    EDM_Compare Result    @{Result[0]}    0    age

EDM_SIT_TLP_customerinfo_0001_0092_Validate Sa_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and sa ='' or sa ='blank'
    EDM_Compare Result    @{Result[0]}    0    sa

EDM_SIT_TLP_customerinfo_0001_0093_Validate DurationInsurance_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and durationinsurance ='' or durationinsurance ='blank'
    EDM_Compare Result    @{Result[0]}    0    durationinsurance

EDM_SIT_TLP_customerinfo_0001_0094_Validate CustomerDuration_NotBlank
    [Documentation]    set CustomerDuration โดยเช็คว่าถ้า PolicyNo. เป็น ppi จะสามารถมีค่าว่างได้
    ...    - Case: Set CustomerDuration หาข้อมูลไม่เป็น PPI แล้วมีค่าว่าง หากพบ Wirte Error
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ \ \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) AND \ \ (customerduration = '' or customerduration ='blank') AND \ a.policyno NOT IN ('00600100', '00600800', '00601100', '00601200', '00601300', '00601301', '00601400', '00601500', '00601501', '00601600', '00601700', '00601701', '00601800', '00601801', '00601900', '00602000', '00602100', '00602101') --PPI_Policyno
    EDM_Compare Result    @{Result[0]}    0    customerduration

EDM_SIT_TLP_customerinfo_0001_0095_Validate ExtraRate_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and extrarate ='' or extrarate ='blank'
    EDM_Compare Result    @{Result[0]}    0    extrarate

EDM_SIT_TLP_customerinfo_0001_0096_Validate EffectiveDate_Default
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) and effectivedate \ not between '0000-00-00' and '3000-12-31' or length(effectivedate) <> 8
    EDM_Compare Result    @{Result[0]}    0    effectivedate

EDM_SIT_TLP_customerinfo_0001_0097_Validate ExpiredDate_Default
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where (a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) and expireddate \ not between '0000-00-00' and '3000-12-31' or length(expireddate) <> 8) \ and expireddate <>'00000000'
    EDM_Compare Result    @{Result[0]}    0    expireddate

EDM_SIT_TLP_customerinfo_0001_0098_Validate LastPayDate_Default
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) \ and (lastpaydate \ not between '0000-00-00' and '3000-12-31' or length(lastpaydate) <> 8) and lastpaydate <> '00000000'
    EDM_Compare Result    @{Result[0]}    0    lastpaydate

EDM_SIT_TLP_customerinfo_0001_0099_Validate LastReceiptNo_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) \ and a.lastreceiptno =''
    EDM_Compare Result    @{Result[0]}    0    lastreceiptno

EDM_SIT_TLP_customerinfo_0001_0100_Validate Address1_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) \ and address1 is null
    EDM_Compare Result    @{Result[0]}    0    address1

EDM_SIT_TLP_customerinfo_0001_0101_Validate Address2_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) \ and address2 is null
    EDM_Compare Result    @{Result[0]}    0    address2

EDM_SIT_TLP_customerinfo_0001_0102_Validate HomeTel_NotNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) \ and hometel is null
    EDM_Compare Result    @{Result[0]}    0    hometel

EDM_SIT_TLP_customerinfo_0001_0103_Validate Mode_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.customerinfo a \ \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and Mode ='' or Mode ='blank'
    EDM_Compare Result    @{Result[0]}    0    Mode

EDM_SIT_TLP_customerinfo_0001_0104_Validate Mode_Default
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.customerinfo a \ where a.customerstatus in (select customerstatus from lookup.tlppolicystatus) \ and (a.mode not in ('9','1','2','4','0','') or length(a.mode) > 1);
    EDM_Compare Result    @{Result[0]}    0    Mode

EDM_SIT_TLP_customerinfo_0001_0105_Validate Check_Policyno_notin_Customersa
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ ( (SELECT sa.policyno, sa.customercode FROM tlp.customersa sa JOIN tlp.customerinfo info ON sa.policyno = info.policyno AND sa.customercode = info.customercode WHERE info.customerstatus IN (SELECT customerstatus FROM lookup.tlppolicystatus)) except all (SELECT info.policyno, info.customercode FROM tlp.customerinfo info \ inner join \ \ (SELECT policyno as policyno \ \ FROM tlp.customerinfo except select tlpplancode as policyno from lookup.tlpppi) x \ \ on x.policyno = info.policyno WHERE info.customerstatus IN (SELECT customerstatus FROM lookup.tlppolicystatus)) )tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM_SIT_TLP_customerinfo_0001_0106_Validate AyCapPolicyGroup_CreditCardDuplicate
    [Documentation]    ตรวจสอบ กรณีที่ Policy อยู่ในกลุ่ม Aycap Fix
    ...    จะต้องมี CreditCardNo ไม่ซ้ำกัน
    ...
    ...    - Aycap Fix Policy
    ...    - '00603900','00604000','00604200','01006014',
    ...    - '01006023','00603500','01006015','01006024',
    ...    - '00603700','00603600','00600600','00600601',
    ...    - '00600602','01006020','00604100','00604300'
    EDM_Connect_DB
    @{Result}    Query    SELECT count(tmp.creditcardno) FROM ( SELECT creditcardno ,count(creditcardno) FROM tlp.customerinfo \ WHERE customerstatus IN (SELECT customerstatus FROM lookup.tlppolicystatus) AND \ policyno IN ( '00603900','00604000','00604200','01006014', '01006023','00603500','01006015','01006024', '00603700','00603600','00600600','00600601', '00600602','01006020','00604100','00604300') AND creditcardno <> '' GROUP BY creditcardno HAVING count(creditcardno) > 1) tmp;
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM_SIT_TLP_customerinfo_0001_0107_Validate AyCapPolicyGroup_CreditCard_Null
    [Documentation]    ตรวจสอบ กรณีที่ Policy อยู่ในกลุ่ม Aycap Fix
    ...    จะต้องมี CreditCardNo เสมอ
    ...
    ...    - Aycap Fix Policy
    ...    - '00603900','00604000','00604200','01006014',
    ...    - '01006023','00603500','01006015','01006024',
    ...    - '00603700','00603600','00600600','00600601',
    ...    - '00600602','01006020','00604100','00604300'
    EDM_Connect_DB
    @{Result}    Query    SELECT count(creditcardno) FROM tlp.customerinfo \ WHERE customerstatus IN (SELECT customerstatus FROM lookup.tlppolicystatus) AND \ policyno IN ( '00603900','00604000','00604200','01006014', '01006023','00603500','01006015','01006024', '00603700','00603600','00600600','00600601', '00600602','01006020','00604100','00604300') AND creditcardno = '';
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM_SIT_TLP_customerinfo_0001_0108_Validate incorrect LastReceiptNo_format(000000000000[12 digits])
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM ( SELECT a.customercode, a.accountno, a.lastreceiptno FROM tlp.customerinfo a JOIN tlp.payment b ON (a.accountno = b.accno) WHERE a.customerstatus IN (SELECT customerstatus FROM lookup.tlppolicystatus) AND \ a.policyno NOT IN ('00026009','00026010') AND \ a.lastreceiptno = '000000000000') tmp ;
    EDM_Compare Result    @{Result[0]}    0    lastreceiptno

EDM_SIT_TLP_customerinfo_0001_0109_Validate lastPayPeriod_in_Payment.PayPeriod
    EDM_Connect_DB
    @{Result}    Query    select count(0) from (SELECT a.customercode, a.mode, a.lastpayperiod \ FROM tlp.customerinfo a JOIN tlp.payment b ON a.customercode = b.customercode WHERE a.customerstatus IN (SELECT customerstatus FROM lookup.tlppolicystatus) \ EXCEPT SELECT b.customercode, b.mode, b.payperiod FROM tlp.payment b)tmp
    EDM_Compare Result    @{Result[0]}    0    lastpayperiod

EDM_SIT_TLP_customerinfo_0001_0110_Validate ExpiredCreditCard_Check_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) FROM tlp.customerinfo where customerstatus in (select * from lookup.tlppolicystatus) and length(expiredcreditcard) <> 4
    EDM_Compare Result    @{Result[0]}    0    expiredcreditcard
