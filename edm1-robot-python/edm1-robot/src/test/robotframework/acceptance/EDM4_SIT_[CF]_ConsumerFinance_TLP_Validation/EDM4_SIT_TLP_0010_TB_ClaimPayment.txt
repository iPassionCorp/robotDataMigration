*** Settings ***
Library           DatabaseLibrary
Resource          ../../keywords/edm.txt
Resource          ../../Repositories/${env}/${dbname}_${env}_Connection.txt

*** Test Cases ***
EDM4_SIT_TLP_TB_ClaimPayment_0010_0001_Validate PAID_DATE_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.claimpayment a \ where a.paid_date= '' or a.paid_date= 'blank';
    EDM_Compare Result    @{Result[0]}    0    PAID_DATE

EDM4_SIT_TLP_TB_ClaimPayment_0010_0002_Validate PAID_DATE_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.claimpayment a \ WHERE a.PAID_DATE~* '[a-zA-Z,]';
    EDM_Compare Result    @{Result[0]}    0    PAID_DATE

EDM4_SIT_TLP_TB_ClaimPayment_0010_0003_Validate PAID_DATE_CheckDate
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.claimpayment \ where to_number(substring(PAID_DATE,7,2),'99') not between 0 and 31 ;
    EDM_Compare Result    @{Result[0]}    0    PAID_DATE

EEDM4_SIT_TLP_TB_ClaimPayment_0010_0004_Validate PAID_DATE_CheckMonth
    EDM_Connect_DB
    @{Result}    Query    SELECT \ count(0) \ \ FROM tlp.claimpayment \ where to_number(substring(PAID_DATE,5,2),'99') not between 0 and 12 ;
    EDM_Compare Result    @{Result[0]}    0    PAID_DATE

EDM4_SIT_TLP_TB_ClaimPayment_0010_0005_Validate CREATEDATE_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.claimpayment a \ where a.CREATEDATE= '' or a.CREATEDATE= 'blank';
    EDM_Compare Result    @{Result[0]}    0    CREATEDATE

EDM4_SIT_TLP_TB_ClaimPayment_0010_0006_Validate payRate_NotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ from tlp.claimpayment a \ where a.payRate= '' or a.payRate= 'blank';
    EDM_Compare Result    @{Result[0]}    0    payRate
