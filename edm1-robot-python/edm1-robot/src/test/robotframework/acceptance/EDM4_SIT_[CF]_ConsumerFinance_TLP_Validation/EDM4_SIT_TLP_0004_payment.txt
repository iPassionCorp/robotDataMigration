*** Settings ***
Resource          ../../Repositories/${env}/${dbname}_${env}_Connection.txt
Resource          ../../keywords/edm.txt
Library           DatabaseLibrary

*** Test Cases ***
EDM4_SIT_TLP_Payment_0004_0001_Validate PolicyNo_notNull
    EDM_Connect_DB
    @{Result}    Query    select count( 0 ) from tlp.payment a where a.PolicyNo = '' and a.policyNo = 'blank';
    EDM_Compare Result    @{Result[0]}    0    PolicyNo

EDM4_SIT_TLP_Payment_0004_0002_Validate ProductCode_notNull
    EDM_Connect_DB
    @{Result}    Query    select count( 0 ) from tlp.payment a where a.productcode = '' and a.productcode = 'blank';
    EDM_Compare Result    @{Result[0]}    0    ProductCode

EDM4_SIT_TLP_Payment_0004_0003_Validate CustomerCode_notNull
    EDM_Connect_DB
    @{Result}    Query    select count( 0 ) from tlp.payment a where a.CustomerCode= '' and a.CustomerCode= 'blank';
    EDM_Compare Result    @{Result[0]}    0    CustomerCode

EDM4_SIT_TLP_Payment_0004_0004_Validate PartnerCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.partnercode) > 50;
    EDM_Compare Result    @{Result[0]}    0    PartnerCode

EDM4_SIT_TLP_Payment_0004_0005_Validate PolicyNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.policyno) > 50; \
    EDM_Compare Result    @{Result[0]}    0    PolicyNo

EDM4_SIT_TLP_Payment_0004_0006_Validate PolicyNo_IsNotChar
    EDM_Connect_DB
    @{Result}    Query    SELECT count(0) FROM tlp.payment a \ WHERE a.PolicyNo~* '[a-zA-Z,]';
    EDM_Compare Result    @{Result[0]}    0    PolicyNo

EDM4_SIT_TLP_Payment_0004_0007_Validate ProductCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.productcode) > 50;
    EDM_Compare Result    @{Result[0]}    0    ProductCode

EDM4_SIT_TLP_Payment_0004_0008_Validate TypeOfPayment_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.typeofpayment) > 50;
    EDM_Compare Result    @{Result[0]}    0    TypeOfPayment

EDM4_SIT_TLP_Payment_0004_0009_Validate CustomerCode_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.customercode) > 50;
    EDM_Compare Result    @{Result[0]}    0    CustomerCode

EDM4_SIT_TLP_Payment_0004_0010_Validate AccNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.accno) > 50;
    EDM_Compare Result    @{Result[0]}    0    AccNo

EDM4_SIT_TLP_Payment_0004_0011_Validate InvoiceNo_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.invoiceno) > 50;
    EDM_Compare Result    @{Result[0]}    0    InvoiceNo

EDM4_SIT_TLP_Payment_0004_0012_Validate Refund_length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ \ \ from tlp.payment a \ \ where length(a.refund) > 20;
    EDM_Compare Result    @{Result[0]}    0    Refund

EDM4_SIT_TLP_Payment_0004_0013_CheckPolicynotinCustomerinfo
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ (select a.policyno, a.customercode FROM tlp.customerinfo a \ where a.customerstatus in \ (select customerstatus from lookup.tlppolicystatus) \ except all select b.policyno , b.customercode \ from tlp.payment b) tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM4_SIT_TLP_Payment_0004_0014_CheckPolicynotinCustomersa
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ (select a.policyno,a.customercode FROM tlp.customersa a \ except all select b.policyno,b.customercode \ from tlp.payment b) tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM4_SIT_TLP_Payment_0004_0015_CheckPolicynotinsplitamount
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ (select a.grouppolicyno, a.customercode FROM tlp.splitpremiumamount a \ \ except all select b.policyno , b.customercode \ from tlp.payment b) tmp
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM4_SIT_TLP_Payment_0004_0015_CheckPolicynoDuplicate
    EDM_Connect_DB
    @{Result}    Query    select count(0) from \ (select policyno, customercode, count(0) \ from tlp.payment tlp \ \ group by policyno, customercode \ having count(0) > 1) tmp;
    EDM_Compare Result    @{Result[0]}    0    policyno

EDM4_SIT_TLP_Payment_0004_0016_Validate PartnerCode_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.payment a \ where a.partnercode = '' or a.partnercode is \ null
    EDM_Compare Result    @{Result[0]}    0    PartnerCode

EDM4_SIT_TLP_Payment_0004_0017_Validate TypeOfPayment_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.payment a \ where a.TypeOfPayment = '' or a.TypeOfPayment is \ null
    EDM_Compare Result    @{Result[0]}    0    TypeOfPayment

EDM4_SIT_TLP_Payment_0004_0018_Validate AccNo_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.payment a \ where a.AccNo = '' or a.AccNo is \ null
    EDM_Compare Result    @{Result[0]}    0    AccNo

EDM4_SIT_TLP_Payment_0004_0019_Validate Refund_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.payment a \ where a.Refund = '' or a.Refund is \ null
    EDM_Compare Result    @{Result[0]}    0    Refund

EDM4_SIT_TLP_Payment_0004_0020_Validate InvoiceNo_notNull
    EDM_Connect_DB
    @{Result}    Query    select count(0) from tlp.payment a \ where a.InvoiceNo = '' or a.InvoiceNo is \ null
    EDM_Compare Result    @{Result[0]}    0    InvoiceNo
