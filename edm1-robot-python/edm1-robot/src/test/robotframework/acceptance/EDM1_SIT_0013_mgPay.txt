*** Settings ***
Resource          ../keywords/edm1_sit.txt
Resource          ../Repositories/EDM1_Cloud_Connection.txt
Library           DatabaseLibrary

*** Test Cases ***
EDM1_SIT_0013_0001
    [Documentation]    ตรวจจำนวน column ที่เก็บใน Table "mgpay" มีจำนวน 26 column ดังนี้
    ...    1. certNo
    ...    2. receiveDate
    ...    3. accidentDate
    ...    4. sectionCode
    ...    5. orderNo
    ...    6. policyStatus
    ...    7. policyStatusDate
    ...    7. policyStatus2
    ...    9. policyStatusDate2
    ...    10. branchCode
    ...    11. serviceBranch
    ...    12. claimType
    ...    13. payType
    ...    14. proofInsuredAge
    ...    15. disabilityType
    ...    16. disnumber
    ...    17. payRate
    ...    18. payAmount
    ...    19. accdAmount
    ...    20. surrenderAmount
    ...    21. returnAmount
    ...    22. deductAmount
    ...    23. claimOkDate
    ...    24. claimPayDate
    ...    25. allowType
    ...    26. bookStatus
    EDM1_connect to EDM1
    #---- Default ----
    ${TotalColumn}    EDM1_Count by query    SELECT count (c.column_name) FROM information_schema.columns c WHERE c.table_name = 'mgpay' AND c.table_schema = 'dm'
    Should Be Equal As Integers    ${TotalColumn}    25
    log    Column of MGOrder table is ${TotalColumn}

EDM1_SIT_0013_0002
    [Documentation]    Run SQL Script ตรวจความยาวของแต่ละ column ที่เก็บต้องไม่เกิน length ที่ระบุในเอกสาร
    ...    1. certNo = 8
    ...    2. receiveDate = 8
    ...    3. accidentDate = 8
    ...    4. sectionCode = 2
    ...    5. orderNo = 8
    ...    6. policyStatus = 1
    ...    7. policyStatusDate = 8
    ...    8. policyStatus2 = 1
    ...    9. policyStatusDate2 = 8
    ...    10. branchCode = 3
    ...    11. serviceBranch = 3
    ...    12. claimType = 1
    ...    13. payType = 1
    ...    14. proofInsuredAge = 2
    ...    15. disabilityType = 1
    ...    16. disnumber = 1
    ...    17. payRate = 3
    ...    18. payAmount = 12
    ...    19. accdAmount = 12
    ...    20. surrenderAmount = 12
    ...    21. returnAmount = 12
    ...    22. deductAmount = 12
    ...    23. claimOkDate = 8
    ...    24. claimPayDate = 8
    ...    25. allowType = 1
    ...    26. bookStatus = 1
    EDM1_connect to EDM1
    #---- Get Total Column----
    @{columnCount}=    Query    SELECT count(a.column_name) FROM information_schema.columns a WHERE a.table_name = 'mgpay' AND a.data_type = 'character varying'
    ${TotalColumn}=    Convert To Integer    @{columnCount[0]}
    #----Get Column Size----
    ${lenOfColumn}=    query    SELECT a.column_name,a.character_maximum_length FROM information_schema.columns a WHERE a.table_name = 'mgpay' AND a.data_type = 'character varying'
    ${i}=    Set Variable    0
    : FOR    ${i}    IN RANGE    ${i}    ${TotalColumn}
    \    Log Many    ${lenOfColumn[${i}]}
    \    Exit For Loop If    '${i}' == '${TotalColumn}'
    #Verify All feild length
    @{columnCount}=    Query    SELECT \ count (*) FROM dm.mgpayrider WHERE length (certNo) > 8 OR length (accidentDate) > 8 OR length (receiveDate) > 8 OR length (sectionCode) > 2 OR length (orderNo) > 8 OR length (policyStatus) > 1 OR length (policyStatusDate) > 8 OR length (policyStatus2) > 1 OR length (policyStatusDate2) > 8 OR length (branchCode) > 3 OR length (serviceBranch) > 3 OR length (ameStartDate) > 8 OR length (ameDay) > 3 OR length (ameExpense) > 9 OR length (amePayment) > 9 OR length (tdDay) > 3 OR length (tdStartDate) > 8 OR length (tdPayment) > 9 OR length (returnAmount) > 12 OR length (deductAmount) > 12 OR length (voidDate) > 8 OR length (claimOkDate) > 8 OR length (claimPayDate) > 8 ;
    ${TotalColumn}=    Convert To Integer    @{columnCount[0]}

EDM1_SIT_0013_0003_certNo
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ certNo
    ...    - certNo = auto generate by TLI โดยนำ tlp.claimRegisterHeader.RegCustomerCertificateNo ไปหาเลข CertNo ที่ gen โดย TLI สร้างขึ้นในแฟ้มหรือ method ที่ TLI สร้างขึ้น
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (ch.regcustomercertificateno = cm.rcertno) and (mgp.certno <> cm.certno)
    EDM1_Compare Result    ${result}    0    certNo

EDM1_SIT_0013_0004_receiveDate
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ receiveDate ดังนี้
    ...    - receiveDate \ = tlp.claimRegisterDetail.RegDtlRegisterDate
    ...    *แสดงวันที่ เป็น พศ และเอาเวลาออก
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where mgp.receiveDate <> cd.RegDtlRegisterDate
    EDM1_Compare Result    ${result}    0    receiveDate

EDM1_SIT_0013_0005_receiveDate
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ accidentDate ดังนี้
    ...    - accidentDate = tlp.claimRegisterDetail.RegDtlDateOfOccurred
    ...    *แสดงวันที่ เป็น พศ และเอาเวลาออก
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where mgp.accidentDate <> cd.RegDtlDateOfOccurred
    EDM1_Compare Result    ${result}    0    receiveDate

EDM1_SIT_0013_0006_sectionCode
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ sectionCode
    ...    - sectionCode = default "95"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where mgp.sectionCode <> '95'
    EDM1_Compare Result    ${result}    0    sectionCode

EDM1_SIT_0013_0007_orderNo
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ orderNo ดังนี้
    ...    - orderNo = tlp.claimRegisterDetail.RegDtlClaimNo
    ...
    ...    โดยก่อนส่งมาให้ TLI ข้อมูลจะถูกแปลงดังนี้
    ...    1. ตัด"." และ "/" ออก
    ...    2. ย้ายปี 2 หลักสุดท้ายมาไว้ก่อนหน้าตัวอักษรภาษาอังกฤษ เช่น C.01762/16 --> 16C01762"
    ...    3. แปลงปี คศ. เป็น พศ.
    ...    4. เปลี่ยนจาก C เป็น CP
    ...    5. ตัวเลขตัดหลักแรกให้เหลือ 4 หลัก
    ...    ดังนั้น จากเดิม \ "C.01762/16" จะถูกส่งมาเป็น "60CP1762"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where mgp.orderNo <> substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4)
    EDM1_Compare Result    ${result}    0    orderNo

EDM1_SIT_0013_0008_policyStatus = "I"
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ policyStatus กรณี tlp.claimRegisterDetail.RegDtlPolicyStatus = blank หรือ "ACTIVE"
    ...    - policyStatus = "I"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (trim(cd.RegDtlPolicyStatus) = '' and trim(mgp.policyStatus) <> 'I') or \ \ \ \ \ \ \ (trim(cd.RegDtlPolicyStatus) = 'ACTIVE' and trim(mgp.policyStatus) <> 'I')
    EDM1_Compare Result    ${result}    0    policyStatus = "I"

EDM1_SIT_0013_0009_policyStatus = "D"
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ policyStatus กรณี tlp.claimRegisterDetail.RegDtlPolicyStatus = "DEATH"
    ...    - policyStatus = "D"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (trim(cd.RegDtlPolicyStatus) = 'DEATH' and trim(mgp.policyStatus) <> 'D')
    EDM1_Compare Result    ${result}    0    policyStatus = "D"

EDM1_SIT_0013_0010_policyStatus = "C"
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ policyStatus กรณี tlp.claimRegisterDetail.RegDtlPolicyStatus = "CANCEL"
    ...    - policyStatus = "C"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (trim(cd.RegDtlPolicyStatus) = 'CANCEL' and trim(mgp.policyStatus) <> 'C')
    EDM1_Compare Result    ${result}    0    policyStatus = "C"

EDM1_SIT_0013_0011_policyStatusDate = default
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ policyStatusDate กรณี policyStatus = "I"
    ...    - policyStatusDate = default "00000000"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.policyStatus) = 'I' and trim(mgp.policyStatusDate) <> '00000000'
    EDM1_Compare Result    ${result}    0    policyStatusDate = default

EDM1_SIT_0013_0012_policyStatus = "D"
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ \ policyStatusDate กรณี policyStatus = "D"
    ...    - policyStatusDate = tlp.claimRegisterDetail.RegDtlDateOfOccurred
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.policyStatus) = 'D' and trim(mgp.policyStatusDate) <> cd.RegDtlDateOfOccurred
    EDM1_Compare Result    ${result}    0    policyStatus = "D"

EDM1_SIT_0013_0013_policyStatus = "C"
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ \ policyStatusDate กรณี policyStatus = "C"
    ...    - policyStatusDate = tlp.claimRegisterDetail.RegDtlApproveDate
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.policyStatus) = 'C' and trim(mgp.policyStatusDate) <> cd.RegDtlApproveDate
    EDM1_Compare Result    ${result}    0    policyStatus = "C"

EDM1_SIT_0013_0014_policyStatus2
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ policyStatus2
    ...    - policyStatus2 = default blank
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.policyStatus2) <> ''
    EDM1_Compare Result    ${result}    0    policyStatus2

EDM1_SIT_0013_0015_policyStatusDate2 = default
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ policyStatusDate2
    ...    - policyStatusDate2 = default "00000000"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.policyStatusDate2) <> '00000000'
    EDM1_Compare Result    ${result}    0    policyStatusDate2 = default

EDM1_SIT_0013_0016_policyStatusDate2 = default
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ branchCode
    ...    - \ branchCode = TB_claimRegisterDetail.branchCode
    ...
    ...    นำค่า TB_ClaimRegisterDetail.branchCode ไป Mapping ค่าจากลิงค์ด้านล่าง sheet "detail" หมายเลข 17
    log    ทำความเข้าใจการ map ค่า branchcode กับ details หมายเลข 17
    Comment    EDM1_connect to EDM1
    Comment    #---- Get Total Column----
    Comment    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.policyStatusDate2) <> '00000000'
    Comment    EDM1_Compare Result    ${result}    0    policyStatusDate2 = default

EDM1_SIT_0013_0017_serviceBranch = default
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ serviceBranch
    ...    - serviceBranch = default "000"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where trim(mgp.serviceBranch) <> '000'
    EDM1_Compare Result    ${result}    0    serviceBranch = default

EDM1_SIT_0013_0018_claimType = "A"
    [Documentation]    Run SQL Script ตรวจสอบข้อมูลในฟิลด์ \ claimType กรณีtlp.ClaimRegisterDetai.ClaimTypeSeq \ = 11 : TTD , 4 : AME , 40 : GME
    ...    - claimType = "A"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE (mgp.claimtype = 'A' AND cd.claimtypeseq NOT IN ('11','4','40'))
    EDM1_Compare Result    ${result}    0    claimType = "A"

EDM1_SIT_0013_0019_claimType = "D"
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ claimType กรณี tlp.claimRegisterDetai.ClaimTypeSeq = 3 : Death , S : Suicide
    ...    - claimType = "D"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE (mgp.claimtype = 'D' AND cd.claimtypeseq NOT IN ('3','S'))
    EDM1_Compare Result    ${result}    0    claimType = "D"

EDM1_SIT_0013_0020_claimType = "T"
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ claimType กรณี tlp.claimRegisterDetai.ClaimTypeSeq = 10 : TPD, 2 : ADD
    ...    - claimType = "T"
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE \ (mgp.claimtype = 'T' AND cd.claimtypeseq NOT IN ('10','2'))
    EDM1_Compare Result    ${result}    0    claimType = "T"

EDM1_SIT_0013_0021_payType
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ payType กรณี tlp.claimRegisterDetail.payType มีค่า 0-8
    ...    - payType = tlp.claimRegisterDetail.payType
    EDM1_connect to EDM1
    #---- Get Total Column----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (cd.paytype in ('0','1','2','3','4','5','6','7','8')) and (mgp.payType <> cd.payType)
    EDM1_Compare Result    ${result}    0    payType

EDM1_SIT_0013_0022_proofInsuredAge
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ proofInsuredAge
    ...    กรณีที่1: ความยาว <= 2 หลัก
    ...    - proofInsuredAge = tlp.claimRegisterHeader.Age
    ...
    ...    กรณีที่2: ความยาว > 2 หลัก หรือ blank
    ...    - proofInsuredAge = default '00'
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where length(ch.Age) <= 2 and mgp.proofInsuredAge <> ch.age
    EDM1_Compare Result    ${result}    0    proofInsuredAge length <=2 Count :
    #---- กรณีที่2: ความยาว > 2 หลัก หรือ blank----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (length(ch.Age) > 2 or ch.age = '') and mgp.proofInsuredAge <> '00'
    EDM1_Compare Result    ${result}    0    proofInsuredAge length > 2 Count :

EDM1_SIT_0013_0023_disabilityType = "0"
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ disabilityType กรณี tli.claimtype = "D"
    ...    - disabilityType = "0" \
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where mgp.claimtype = 'D' and mgp.disabilitytype <> '0'
    EDM1_Compare Result    ${result}    0    disabilityType = "0"

EDM1_SIT_0013_0024_disabilityType = "1"
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ disabilityType กรณี tlp.claimRegisterDetail.RegDtlClaimGroup = "I" (Illness)
    ...    - disabilityType = "1" \
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (mgp.claimtype <> 'D' and cd.RegDtlClaimGroup = 'I') and \ mgp.disabilitytype <> '1'
    EDM1_Compare Result    ${result}    0    disabilityType = "1"

EDM1_SIT_0013_0025_disabilityType = "2"
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ disabilityType กรณี tlp.claimRegisterDetail.RegDtlClaimGroup = "A" (Accident)
    ...    - disabilityType = "2"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where (mgp.claimtype <> 'D' and cd.RegDtlClaimGroup = 'A') and \ mgp.disabilitytype <> '2'
    EDM1_Compare Result    ${result}    0    disabilityType = "2"

EDM1_SIT_0013_0026_disnumber = default "0"
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ disnumber
    ...    - disnumber = default "0"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ where mgp.disnumber <> '0'
    EDM1_Compare Result    ${result}    0    disnumber = default "0"

EDM1_SIT_0013_0027_payrate
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ payRate กรณี tlp.claimPayment.payRate <> blank (มีข้อมูล) และความยาว <= 3 ตัวอักษร
    ...    - payrate = tlp.claimPayment.payRate
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ JOIN tlp.claimpayment cp on (cd.registerseq = cp.registerseq and cd.regdtlclaimno = cp.claimno) \ where (cp.payrate <> '' and length(cp.payrate) <= 3) and mgp.payrate <> cp.payrate
    EDM1_Compare Result    ${result}    0    payrate

EDM1_SIT_0013_0028_payrate
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ payRate กรณี tlp.claimPayment.payRate = blank \ (ไม่มีข้อมูล) หรือความยาว > 4
    ...    - payrate = default "000"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ JOIN tlp.claimpayment cp on (cd.registerseq = cp.registerseq and cd.regdtlclaimno = cp.claimno) \ where (cp.payrate = '' or length(cp.payrate) > 4) and mgp.payrate <> '000'
    EDM1_Compare Result    ${result}    0    payrate

EDM1_SIT_0013_0029_payAmount
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ payAmount กรณี tlp.ClaimRegisterDetail.ClaimTypeSeq \ = [3(DTH) หรือ 10(TPD)]
    ...    - payAmount = TB_ClaimRegisterDetail.RegDtlTotalAmount
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE cd.claimtypeseq IN ('3','10') \ \ \ \ \ \ \ \ and mgp.payamount <> replace(to_char(to_number(cd.RegDtlTotalAmount,'999999999900D99'), '999999999V99'),' ','0')
    EDM1_Compare Result    ${result}    0    payAmount

EDM1_SIT_0013_0030_payAmount = default
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ payAmount กรณี tlp.claimRegisterDetail.ClaimTypeSeq \ <> [3(DTH) หรือ 10(TPD)]
    ...    - payAmount = default "0.00"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE cd.claimtypeseq not IN ('3','10') \ \ \ \ \ \ \ \ and mgp.payamount <> '000000000000'
    EDM1_Compare Result    ${result}    0    payAmount = default

EDM1_SIT_0013_0031_accdAmount
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ accdAmount กรณีtlp.claimRegisterDetail.ClaimTypeSeq \ = "2" (ADD)
    ...    - accdAmount = tlp.claimRegisterDetail.RegDtlTotalAmount
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE cd.claimtypeseq IN ('2') \ \ \ \ \ \ \ \ and mgp.accdAmount <> replace(to_char(to_number(cd.RegDtlTotalAmount,'999999999900D99'), '999999999V99'),' ','0')
    EDM1_Compare Result    ${result}    0    accdAmount

EDM1_SIT_0013_0032_accdAmount = default
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ accdAmount กรณี tlp.claimRegisterDetail.ClaimTypeSeq \ <> "2" (ADD)
    ...    - accdAmount = default "0.00"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE cd.claimtypeseq not IN ('2') \ \ \ \ \ \ \ and mgp.accdamount <> '000000000000'
    EDM1_Compare Result    ${result}    0    accdAmount = default

EDM1_SIT_0013_0033_surrenderAmount = default
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ surrenderAmount
    ...    - surrenderAmount = default "0.00"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE mgp.surrenderAmount <> '000000000000'
    EDM1_Compare Result    ${result}    0    surrenderAmount = default

EDM1_SIT_0013_0034_returnAmount
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ returnAmount กรณี tlp.claimRegisterDetail.RegDtlVoidAmount > 0.00
    ...    - returnAmount = tlp.claimRegisterDetail.RegDtlVoidAmount
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) \ from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE to_number(cd.RegDtlVoidAmount ,'999999999900D99') > 0 \ \ \ \ \ \ \ \ and mgp.returnAmount <> replace(to_char(to_number(cd.RegDtlVoidAmount,'999999999900D99'), '999999999V99'),' ','0')
    EDM1_Compare Result    ${result}    0    returnAmount

EDM1_SIT_0013_0035_returnAmount
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ returnAmount กรณี tlp.claimRegisterDetail.RegDtlVoidAmount = 0.00 และ tlp.claimRegisterDetail.RegDtlAdjustPayment >= 0.00 (เป็นค่าบวก)
    ...    - returnAmount = tlp.claimRegisterDetail.RegDtlAdjustPayment
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) \ from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE (to_number(cd.RegDtlVoidAmount ,'999999999900D99') = 0 and to_number(cd.RegDtlAdjustPayment,'999999999900D99') >= 0) \ \ \ \ \ \ \ \ and mgp.returnAmount <> replace(to_char(to_number(cd.RegDtlAdjustPayment,'999999999900D99'), '999999999V99'),' ','0')
    EDM1_Compare Result    ${result}    0    returnAmount

EDM1_SIT_0013_0036_returnAmount_default
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ returnAmount กรณี tlp.claimRegisterDetail.RegDtlVoidAmount = 0.00 และ tlp.claimRegisterDetail.RegDtlAdjustPayment < 0.00 (ค่าติดลบ)
    ...    - returnAmount = default "0.00"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) \ from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE (to_number(cd.RegDtlVoidAmount ,'999999999900D99') = 0 and to_number(cd.RegDtlAdjustPayment,'999999999900D99') < 0) and \ \ \ \ \ \ \ mgp.returnAmount <> '000000000000'
    EDM1_Compare Result    ${result}    0    returnAmount = default

EDM1_SIT_0013_0037_deductAmount
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ deductAmount กรณี tlp.claimRegisterDetail.RegDtlAdjustPayment < 0.00 (ค่าติดลบ)
    ...    - deductAmount = tlp.claimRegisterDetail.RegDtlAdjustPayment
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) \ from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE (to_number(cd.RegDtlAdjustPayment ,'999999999900D99') < 0) \ \ \ \ \ \ \ \ and mgp.deductAmount <> replace(to_char(to_number(cd.RegDtlAdjustPayment,'999999999900D99'), '999999999V99'),' ','0')
    EDM1_Compare Result    ${result}    0    deductAmount

EDM1_SIT_0013_0038_deductAmount_default
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ deductAmount กรณีtlp.claimRegisterDetail.RegDtlAdjustPayment >= 0.00 (ค่าบวก)
    ...    - deductAmount = default "0.00"
    EDM1_connect to EDM1
    #---- กรณีที่1: ความยาว <= 2 หลัก ----
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ --where cd.RegDtlAdjustPayment <> '0.00' \ \ \ where to_number(cd.RegDtlAdjustPayment,'9999999900D99') = 0.00 and (mgp.deductAmount <> trim(to_char(to_number(cd.RegDtlAdjustPayment,'9999999900D99') \ \ \ ,'000000000000'))) OR to_number(cd.RegDtlAdjustPayment,'9999999900D99') > 0.00 and (mgp.deductAmount <> '000000000000')
    EDM1_Compare Result    ${result}    0    deductAmount = default

EDM1_SIT_0013_0039_claimOkDate
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ claimOkDate
    ...    กรณีที่1: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    ...    - claimOkDate = tlp.claimRegisterDetail.RegDtlApproveDate
    ...    กรณีที่2: RegDtlApproveDate มีค่า "00000000" หรือ blank หรือไม่ครบ 8 หลัก
    ...    - claimOkDate = "00000000"
    EDM1_connect to EDM1
    #---- กรณีที่1: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ WHERE (trim(cd.regdtlapprovedate) <> '' OR cd.regdtlapprovedate <> '00000000' or length(cd.regdtlapprovedate) = 8) AND mgp.claimOkDate <> cd.regdtlapprovedate;
    EDM1_Compare Result    ${result}    0    claimOkDate
    #---- กรณีที่2: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ WHERE (trim(cd.regdtlapprovedate) = '' OR cd.regdtlapprovedate = '00000000' or length(cd.regdtlapprovedate) <> 8) AND mgp.claimOkDate <> '00000000';
    EDM1_Compare Result    ${result}    0    claimOkDate = "00000000"

EDM1_SIT_0013_0040_claimPayDate
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ claimPayDate
    ...    กรณีที่1: PAID_DATE มีค่าไม่ใช่ "00000000" หรือ blank
    ...    - claimPayDate = tlp.claimPayment.PAID_DATE
    ...    กรณีที่2: PAID_DATE มีค่า "00000000" หรือ blank หรือไม่ครบ 8 หลัก
    ...    - claimPayDate = "00000000"
    EDM1_connect to EDM1
    #---- กรณีที่1: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ JOIN tlp.claimpayment cp on (cd.registerseq = cp.registerseq and cd.regdtlclaimno = cp.claimno) \ WHERE (trim(cp.paid_date) <> '' OR cp.paid_date <> '00000000' or length(cp.paid_date) = 8) AND mgp.claimPayDate <> cp.paid_date; \
    EDM1_Compare Result    ${result}    0    claimPayDate
    #กรณีที่2: PAID_DATE มีค่า "00000000" หรือ blank หรือไม่ครบ 8 หลัก
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ JOIN tlp.claimpayment cp on (cd.registerseq = cp.registerseq and cd.regdtlclaimno = cp.claimno) \ WHERE (trim(cp.paid_date) = '' OR cp.paid_date = '00000000' or length(cp.paid_date) <> 8) AND mgp.claimPayDate <> '00000000'; \
    EDM1_Compare Result    ${result}    0    claimPayDate

EDM1_SIT_0013_0041_allowType Default Blank
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ allowType
    ...    - allowType = default ค่า blank
    EDM1_connect to EDM1
    #---- กรณีที่1: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ where trim(mgp.allowType) <> ''
    EDM1_Compare Result    ${result}    0    allowType

EDM1_SIT_0013_0042_allowType
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ allowType
    ...    - allowType = default ค่า blank
    log    [Need to Confirm] เนื่องจากเอกสารที่ใช้อ้างอิงมี bookstatus แต่เอกสาร TLP_Claim_Migration และข้อมูลจริงตอนนี้ไม่มี field นี้
    Comment    EDM1_connect to EDM1
    Comment    #---- กรณีที่1: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    Comment    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ where trim(mgp.allowType) <> ''
    Comment    EDM1_Compare Result    ${result}    0    allowType

EDM1_SIT_0013_0043_allowType
    [Documentation]    Run SQL script ตรวจสอบข้อมูลในฟิลด์ \ allowType
    ...    - allowType = default ค่า blank
    log    [Need to Confirm] เนื่องจากเอกสารที่ใช้อ้างอิงมี bookstatus แต่เอกสาร TLP_Claim_Migration และข้อมูลจริงตอนนี้ไม่มี field นี้
    Comment    EDM1_connect to EDM1
    Comment    #---- กรณีที่1: RegDtlApproveDate มีค่าไม่ใช่ "00000000" หรือ blank
    Comment    ${result}    EDM1_Count by query    select count(0) from dm.mgpay mgp JOIN dm.mgclaim mgc ON mgp.orderno = mgc.orderno and mgp.sectioncode = mgc.sectioncode JOIN dm.certmapping cm ON (cm.certno = mgc.certno) \ JOIN tlp.claimregisterheader ch ON (ch.regcustomercertificateno = cm.rcertno) \ JOIN tlp.claimregisterdetail cd \ \ \ ON (cd.registerseq = ch.registerseq \ \ \ \ \ \ \ \ and substring(regdtlclaimno, 1, 2) || 'CP' || substring(regdtlclaimno, 6, 4) \ = mgp.orderno) \ \ \ \ \ \ \ \ \ \ where trim(mgp.allowType) <> ''
    Comment    EDM1_Compare Result    ${result}    0    allowType
